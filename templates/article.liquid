

<!-- Article Schema -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "{{ article.title | strip_html }}",
  "description": "{{ article.excerpt | default: article.content | strip_html | truncate: 160 }}",
  "image": "{{ article.image | img_url: '1200x630' }}",
  "author": {
    "@type": "Person",
    "name": "{{ article.author }}"
  },
  "publisher": {
    "@type": "Organization",
    "name": "{{ shop.name }}",
    "logo": {
      "@type": "ImageObject",
      "url": "{{ 'logo.png' | asset_url }}"
    }
  },
  "datePublished": "{{ article.published_at | date: '%Y-%m-%d' }}",
  "dateModified": "{{ article.updated_at | date: '%Y-%m-%d' }}",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "{{ article.url | prepend: request.host }}"
  }
}
</script>

<main class="max-w-4xl mx-auto px-6 py-8">
  <!-- Breadcrumbs -->
  <nav class="mb-8">
  {% render 'breadcrumbs' %}
  </nav>

  <article class="prose prose-slate max-w-none" itemscope itemtype="https://schema.org/BlogPosting">
    <!-- Article Header -->
    <header class="not-prose mb-12">
      <!-- Meta Info -->
      <div class="flex items-center space-x-2 text-sm text-slate-500 mb-4">
        <time itemprop="datePublished" datetime="{{ article.published_at | date: '%Y-%m-%d' }}">
          {{ article.published_at | date: '%B %d, %Y' }}
        </time>
        <span>•</span>
        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
          By <span itemprop="name">{{ article.author }}</span>
        </span>
        {% if article.tags.size > 0 %}
        <span>•</span>
        <div class="flex items-center space-x-2">
          {% for tag in article.tags limit: 3 %}
          <a 
            href="{{ blog.url }}/tagged/{{ tag | handle }}" 
            class="inline-flex items-center px-2 py-1 rounded-full text-xs bg-amber-100 text-amber-800 hover:bg-amber-200 transition-colors"
          >
            {{ tag }}
          </a>
          {% endfor %}
        </div>
        {% endif %}
      </div>

      <!-- Title -->
      <h1 class="text-4xl md:text-5xl font-bold text-slate-800 leading-tight mb-6" itemprop="headline">
        {{ article.title }}
      </h1>

      <!-- Excerpt -->
      {% if article.excerpt != blank %}
      <p class="text-xl text-slate-600 leading-relaxed mb-8">
        {{ article.excerpt }}
      </p>
      {% endif %}

      <!-- Featured Image -->
      {% if article.image %}
      <div class="aspect-video bg-slate-100 rounded-xl overflow-hidden mb-8">
        <img 
          src="{{ article.image | img_url: '1200x675' }}" 
          alt="{{ article.image.alt | default: article.title }}"
          class="w-full h-full object-cover"
          itemprop="image"
        >
      </div>
      {% endif %}

      <!-- Social Share Bar -->
      <div class="flex items-center justify-between py-4 border-t border-b border-slate-200 mb-8">
        <div class="flex items-center space-x-4">
          <span class="text-sm text-slate-600">Share this article:</span>
          <div class="flex items-center space-x-2">
            <button 
              onclick="shareToTwitter('{{ article.url | prepend: request.host }}', '{{ article.title | escape }}')"
              class="inline-flex items-center px-3 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm"
            >
              <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 24 24">
                <path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/>
              </svg>
              Twitter
            </button>
            <button 
              onclick="shareToFacebook('{{ article.url | prepend: request.host }}')"
              class="inline-flex items-center px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm"
            >
              <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 24 24">
                <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
              </svg>
              Facebook
            </button>
            <button 
              onclick="copyToClipboard('{{ article.url | prepend: request.host }}')"
              class="inline-flex items-center px-3 py-2 bg-slate-600 text-white rounded-lg hover:bg-slate-700 transition-colors text-sm"
            >
              <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
              </svg>
              Copy Link
            </button>
          </div>
        </div>
        <div class="text-sm text-slate-500">
          {{ article.content | strip_html | number_of_words }} words • {{ article.content | strip_html | number_of_words | divided_by: 200 | ceil }} min read
        </div>
      </div>
    </header>

    <!-- Article Content -->
    <div class="prose prose-slate prose-lg max-w-none" itemprop="articleBody">
      {{ article.content }}
    </div>

    <!-- Article Footer -->
    <footer class="not-prose mt-12 pt-8 border-t border-slate-200">
      <!-- Author Bio -->
      <div class="flex items-start space-x-4 mb-8">
        <div class="flex-shrink-0 w-16 h-16 bg-gradient-to-br from-amber-500 to-amber-600 rounded-full flex items-center justify-center text-white font-semibold text-xl">
          {{ article.author | slice: 0 }}
        </div>
        <div class="flex-1">
          <h4 class="font-semibold text-slate-800 mb-1">{{ article.author }}</h4>
          <p class="text-slate-600 text-sm">
            Content creator and wellness enthusiast sharing insights on healthy living, pet care, and lifestyle optimization.
          </p>
        </div>
      </div>

      <!-- Related Products Integration -->
      {% assign related_products = collections.all.products | where: 'tags', article.tags.first | limit: 4 %}
      {% if related_products.size > 0 and article.tags.size > 0 %}
      <div class="bg-amber-50 rounded-xl p-6 mb-8">
        <h3 class="text-xl font-semibold text-slate-800 mb-4">
          Featured {{ article.tags.first }} Products
        </h3>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
          {% for product in related_products %}
          <div class="bg-white rounded-lg p-4 hover:shadow-md transition-shadow">
            <div class="aspect-square bg-slate-100 rounded-lg mb-3 overflow-hidden">
              {% if product.featured_image %}
              <img 
                src="{{ product.featured_image | img_url: '200x200' }}" 
                alt="{{ product.title }}"
                class="w-full h-full object-cover"
              >
              {% endif %}
            </div>
            <h4 class="font-medium text-slate-800 text-sm mb-2 line-clamp-2">
              <a href="{{ product.url }}" class="hover:text-amber-600 transition-colors">
                {{ product.title }}
              </a>
            </h4>
            <p class="text-amber-600 font-semibold text-sm">{{ product.price | money }}</p>
          </div>
          {% endfor %}
        </div>
      </div>
      {% endif %}

      <!-- Tags -->
      {% if article.tags.size > 0 %}
      <div class="mb-8">
        <h4 class="font-semibold text-slate-800 mb-3">Tags:</h4>
        <div class="flex flex-wrap gap-2">
          {% for tag in article.tags %}
          <a 
            href="{{ blog.url }}/tagged/{{ tag | handle }}" 
            class="inline-flex items-center px-3 py-1 rounded-full text-sm bg-slate-100 text-slate-700 hover:bg-amber-100 hover:text-amber-700 transition-colors"
          >
            {{ tag }}
          </a>
          {% endfor %}
        </div>
      </div>
      {% endif %}

      <!-- Navigation -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        {% if blog.previous_article %}
        <div class="card-premium p-6">
          <div class="flex items-start space-x-4">
            <div class="flex-shrink-0">
              <svg class="w-6 h-6 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
              </svg>
            </div>
            <div class="flex-1 min-w-0">
              <p class="text-sm text-slate-500 mb-1">Previous Article</p>
              <h4 class="font-semibold text-slate-800 line-clamp-2">
                <a href="{{ blog.previous_article.url }}" class="hover:text-amber-600 transition-colors">
                  {{ blog.previous_article.title }}
                </a>
              </h4>
            </div>
          </div>
        </div>
        {% endif %}

        {% if blog.next_article %}
        <div class="card-premium p-6">
          <div class="flex items-start space-x-4">
            <div class="flex-1 min-w-0 text-right">
              <p class="text-sm text-slate-500 mb-1">Next Article</p>
              <h4 class="font-semibold text-slate-800 line-clamp-2">
                <a href="{{ blog.next_article.url }}" class="hover:text-amber-600 transition-colors">
                  {{ blog.next_article.title }}
                </a>
              </h4>
            </div>
            <div class="flex-shrink-0">
              <svg class="w-6 h-6 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
              </svg>
            </div>
          </div>
        </div>
    {% endif %}
      </div>
    </footer>
  </article>

  <!-- Related Articles -->
  {% assign related_articles = blog.articles | where: 'tags', article.tags.first | where: 'id', '!=', article.id | limit: 3 %}
  {% if related_articles.size > 0 %}
  <section class="mt-16">
    <h2 class="text-2xl font-bold text-slate-800 mb-8">Related Articles</h2>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
      {% for related_article in related_articles %}
      <article class="card-premium overflow-hidden hover-lift">
        {% if related_article.image %}
        <div class="aspect-video bg-slate-100 overflow-hidden">
          <a href="{{ related_article.url }}">
            <img 
              src="{{ related_article.image | img_url: '400x225' }}" 
              alt="{{ related_article.title }}"
              class="w-full h-full object-cover hover:scale-105 transition-transform duration-300"
            >
          </a>
        </div>
        {% endif %}
        <div class="p-6">
          <div class="text-sm text-slate-500 mb-2">
            {{ related_article.published_at | date: '%B %d, %Y' }}
          </div>
          <h3 class="font-semibold text-slate-800 mb-3 line-clamp-2">
            <a href="{{ related_article.url }}" class="hover:text-amber-600 transition-colors">
              {{ related_article.title }}
            </a>
          </h3>
          <p class="text-slate-600 text-sm line-clamp-3 mb-4">
            {{ related_article.excerpt | default: related_article.content | strip_html | truncate: 120 }}
          </p>
          <a 
            href="{{ related_article.url }}" 
            class="text-amber-600 hover:text-amber-700 font-medium text-sm inline-flex items-center group"
          >
            Read More
            <svg class="w-4 h-4 ml-1 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
            </svg>
          </a>
        </div>
      </article>
      {% endfor %}
    </div>
  </section>
  {% endif %}
</main>

<script>
  function shareToTwitter(url, title) {
    const twitterUrl = `https://twitter.com/intent/tweet?url=${encodeURIComponent(url)}&text=${encodeURIComponent(title)}`;
    window.open(twitterUrl, '_blank', 'width=600,height=400');
  }
  
  function shareToFacebook(url) {
    const facebookUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`;
    window.open(facebookUrl, '_blank', 'width=600,height=400');
  }
  
  function copyToClipboard(url) {
    navigator.clipboard.writeText(url).then(() => {
      // Show success message
      const button = event.target.closest('button');
      const originalText = button.innerHTML;
      button.innerHTML = button.innerHTML.replace('Copy Link', 'Copied!');
      button.classList.add('bg-green-600', 'hover:bg-green-700');
      button.classList.remove('bg-slate-600', 'hover:bg-slate-700');
      
      setTimeout(() => {
        button.innerHTML = originalText;
        button.classList.remove('bg-green-600', 'hover:bg-green-700');
        button.classList.add('bg-slate-600', 'hover:bg-slate-700');
      }, 2000);
    }).catch(err => {
      console.error('Failed to copy: ', err);
    });
  }
</script>

